<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>House Price Prediction</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { max-width: 600px; margin: auto; }
    input, button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      font-size: 16px;
    }
    #result {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: darkblue;
    }
  </style>
</head>
<body>
  <script src="/env.js"></script>
  <div class="container">
    <h2>Predict House Price</h2>
    <form id="predictForm">
      <label>Median Income (10kâ€™s USD): <input type="number" step="0.01" id="MedInc" ></label>
      <label>House Age (years): <input type="number" step="1" id="HouseAge"></label>
      <label>Average Rooms: <input type="number" step="0.01" id="AveRooms"></label>
      <label>Average Bedrooms: <input type="number" step="0.01" id="AveBedrms"></label>
      <label>Population: <input type="number" step="1" id="Population"></label>
      <label>Average Occupancy: <input type="number" step="0.01" id="AveOccup"></label>
      <label>Latitude: <input type="number" step="0.01" id="Latitude"></label>
      <label>Longitude: <input type="number" step="0.01" id="Longitude"></label>
       <button type="submit">Predict Price</button>
    </form>
    <div id="result"></div>
    <div id="message"></div>
  </div>

  <script>
   const getValue = (id, defaultValue) => {
      const value = document.getElementById(id).value;
      return value.trim() === "" ? defaultValue : parseFloat(value);
   };
  
    document.getElementById("predictForm").addEventListener("submit", async function(e) {
      e.preventDefault();
       
      const data = {
        MedInc: getValue("MedInc", 3.0),
        HouseAge: getValue("HouseAge", 20.0),
        AveRooms: getValue("AveRooms", 5.0),
        AveBedrms: getValue("AveBedrms", 1.0),
        Population: getValue("Population", 1000.0),
        AveOccup: getValue("AveOccup", 3.0),
        Latitude: getValue("Latitude", 37.0),
        Longitude: getValue("Longitude", -120.0),
      };
      
      try {
        const response = await fetch(window.API_URL + "/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        
        if (result.success) {
           document.getElementById("result").innerText = "Predicted Price (USD): " + (result.data.predicted_price * 100000).toFixed(0);
           //document.getElementById("message").innerText = "Message: " + result.message;
        }
        else{
          document.getElementById("message").innerText = "Error: " + result.error.message;
        }
        
      } catch (error) {
        document.getElementById("message").innerText = "Error: " + error;
      }
    });
  </script>
</body>
</html>
